@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<div class="main-container">
    <aside class="sidebar">
        <NavMenu />
    </aside>

    <div class="main-content">
        <header class="top-header">
            <div class="search-container">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                <input @bind="searchTerm" @bind:event="oninput" @onkeyup="HandleSearchKeyUp" class="search-input" placeholder="Interstellar, Top 10 Action, Harry Potter..." />
            </div>
            <div class="user-profile-section">
                <button class="mood-btn">What's your mood?</button>
                <div class="profile-icons">
                    <img src="https://i.pravatar.cc/32?u=a042581f4e29026704d" alt="User Avatar" class="avatar" />
                    <img src="https://i.pravatar.cc/32?u=a042581f4e29026705d" alt="User Avatar" class="avatar" />
                </div>
                <LoginDisplay />
            </div>
        </header>

        <main class="content">
            @Body
        </main>
    </div>
</div>

@code {
    private string? searchTerm;

    private async Task HandleSearchKeyUp(KeyboardEventArgs e)
    {
        if (e.Key == "Enter" && !string.IsNullOrWhiteSpace(searchTerm))
        {
            NavigationManager.NavigateTo($"/search/{Uri.EscapeDataString(searchTerm)}");
        }
    }
}
